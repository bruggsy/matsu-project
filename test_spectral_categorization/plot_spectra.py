from cassius import *

# /mnt/pictures-L1G-TIFF/LakeFrome/EO1H0970812012048110P1_HYP_L1G
# in [1200:1880,:]

frome = [(8, 425.574, 5.298221277861963), (9, 435.787, 5.308043339563164), (10, 446.0, 5.325268653185178), (11, 456.213, 5.378447856736821), (12, 466.426, 5.4191677121959865), (13, 476.639, 5.481816346319862), (14, 486.852, 5.427168734064836), (15, 497.065, 5.441999828998449), (16, 507.278, 5.453229602311218), (17, 517.491, 5.410224476407354), (18, 527.704, 5.442161246051867), (19, 537.917, 5.431061333978243), (20, 548.13, 5.431372550348476), (21, 558.343, 5.444296767291987), (22, 568.556, 5.42404050671694), (23, 578.769, 5.413803291526639), (24, 588.982, 5.422752513204578), (25, 599.1949999999999, 5.39208468709837), (26, 609.408, 5.439280632607208), (27, 619.621, 5.4073092221085215), (28, 629.834, 5.368031353295917), (29, 640.047, 5.372024376400941), (30, 650.26, 5.357733888323263), (31, 660.473, 5.307902856570769), (32, 670.6859999999999, 5.358623642497015), (33, 680.899, 5.3452812537832814), (34, 691.112, 5.238003097562823), (35, 701.325, 5.209955582821114), (36, 711.538, 5.132196614319664), (37, 721.751, 4.907732355018524), (38, 731.9639999999999, 5.0302014585859345), (39, 742.1769999999999, 5.160560470776816), (40, 752.39, 5.105337208834907), (41, 762.603, 4.699711205654076), (42, 772.816, 5.101120946641299), (43, 783.029, 5.103490163522089), (45, 803.4549999999999, 4.991087080304779), (46, 813.6679999999999, 4.792864152805678), (47, 823.881, 4.716252587770525), (48, 834.094, 4.811402903904502), (49, 844.307, 4.935663887075266), (50, 854.52, 4.939139500069791), (51, 864.733, 4.925814674462652), (52, 874.9459999999999, 4.895002835882611), (53, 885.159, 4.836647557293881), (54, 895.372, 4.621189331748891), (55, 905.585, 4.369638032737794), (56, 915.798, 4.243766671870156), (57, 926.011, 4.234543134300396), (77, 909.78, 4.37941674862954), (78, 919.89, 4.217694419895777), (79, 930.0, 3.1334970053970634), (80, 940.11, 3.061375382034867), (81, 950.22, 3.155301851322349), (82, 960.33, 3.6819953837618913), (83, 970.44, 3.9944820652392607), (84, 980.55, 4.227726419093929), (85, 990.66, 4.386409194916178), (86, 1000.77, 4.4033822794077), (87, 1010.88, 4.434122486023771), (88, 1020.99, 4.460465485237776), (89, 1031.1, 4.458483021823354), (90, 1041.21, 4.4604367021921805), (91, 1051.32, 4.445494327885569), (92, 1061.43, 4.404191298872871), (93, 1071.54, 4.360164957820512), (94, 1081.65, 4.276199406157117), (95, 1091.76, 4.074887219818771), (96, 1101.87, 3.6885938330348873), (97, 1111.98, 2.6830934355644516), (98, 1122.09, 1.6003953246630973), (99, 1132.2, 2.0391016941123397), (100, 1142.31, 2.00774565307122), (101, 1152.42, 2.5698585210810747), (102, 1162.53, 3.1470187683509505), (103, 1172.6399999999999, 3.301269638500693), (104, 1182.75, 3.303449561465576), (105, 1192.8600000000001, 3.345503180397189), (106, 1202.97, 3.3615444059701614), (107, 1213.08, 3.4692400972650845), (108, 1223.19, 3.5617480170022455), (109, 1233.3, 3.6224316061468937), (110, 1243.4099999999999, 3.6228811541573), (111, 1253.52, 3.537573275919987), (112, 1263.63, 3.3938252618169167), (113, 1273.74, 3.5091071763689414), (114, 1283.85, 3.5135133840561994), (115, 1293.96, 3.3689923132125865), (116, 1304.07, 3.1080911782331695), (117, 1314.1799999999998, 2.803738984911119), (118, 1324.29, 2.334553018260869), (120, 1344.51, 0.488648420248938), (121, 1354.62, -1.18942068873), (123, 1374.84, -1.4529393925593563), (124, 1384.95, -1.5328267772803825), (125, 1395.06, -0.8521397869144018), (126, 1405.17, -0.8980614803887288), (127, 1415.28, -0.9345324174628251), (128, 1425.3899999999999, -0.8671600614576679), (129, 1435.5, -0.7628236914113334), (130, 1445.6100000000001, -0.3957151008927539), (131, 1455.72, 0.07535634193985344), (132, 1465.83, -0.21350713568339696), (133, 1475.94, 0.19624099006959428), (134, 1486.05, 0.8932431901051757), (135, 1496.1599999999999, 1.5402287783804525), (136, 1506.27, 1.8431549272971812), (137, 1516.38, 2.0462233749627217), (138, 1526.49, 2.1987879372654207), (139, 1536.6, 2.3026940000318157), (140, 1546.71, 2.3692664758747735), (141, 1556.82, 2.3920367016979864), (142, 1566.9299999999998, 2.3362725496627204), (143, 1577.04, 2.344231006281084), (144, 1587.15, 2.409729858479274), (145, 1597.26, 2.389791069986176), (146, 1607.37, 2.406209912552378), (147, 1617.48, 2.4774946874251897), (148, 1627.59, 2.494092850011565), (149, 1637.6999999999998, 2.449300158185064), (150, 1647.81, 2.449688648001869), (151, 1657.92, 2.462252302601234), (152, 1668.03, 2.4369554807646576), (153, 1678.1399999999999, 2.4193147967246875), (155, 1698.36, 2.315129617937428), (156, 1708.4699999999998, 2.235187871506792), (157, 1718.58, 2.1414094947693907), (158, 1728.69, 2.0191180556099733), (160, 1748.9099999999999, 1.798620126779439), (161, 1759.02, 1.6113103869207344), (162, 1769.13, 1.288142525143829), (163, 1779.24, 0.8499455081339733), (164, 1789.35, 0.3052702783374138), (165, 1799.46, -0.6635343411649092), (166, 1809.57, -1.2372147335790848), (167, 1819.6799999999998, -1.000996363962489), (168, 1829.79, -0.9724737425029445), (169, 1839.9, -1.070041167230761), (170, 1850.01, -1.0945269982017976), (171, 1860.12, -1.6870362820590112), (172, 1870.23, -1.7507516796569758), (173, 1880.34, -2.072237950313053), (174, 1890.4499999999998, -2.086505978040836), (175, 1900.56, -2.1805901765806563), (176, 1910.67, -2.3234956671041957), (177, 1920.78, -3.8174092359403207), (178, 1930.8899999999999, -3.8932924776464533), (179, 1941.0, -2.070531362889242), (180, 1951.11, -2.046357160775425), (181, 1961.22, -2.621008356713755), (182, 1971.33, -0.9791399072004779), (184, 1991.55, -0.344873300468967), (185, 2001.6599999999999, -2.0541434801510583), (186, 2011.77, -1.6205496118660616), (187, 2021.8799999999999, -6.479262734061759e-06), (188, 2031.99, 0.5297220171516887), (189, 2042.1, 0.4203984648218325), (190, 2052.21, 0.0608926123521369), (191, 2062.3199999999997, 0.24799267689186688), (192, 2072.43, 0.5215820371133946), (193, 2082.54, 0.6750735859607371), (194, 2092.6499999999996, 0.7485952153845479), (195, 2102.76, 0.8230940917643288), (196, 2112.87, 0.8420974864154043), (197, 2122.98, 0.8402663156989469), (198, 2133.09, 0.8973566220105615), (199, 2143.2, 0.9341716982993774), (200, 2153.31, 0.8580479946077983), (201, 2163.42, 0.7518695618785657), (202, 2173.5299999999997, 0.7595435268932132), (203, 2183.64, 0.7770358991358005), (205, 2203.8599999999997, 0.693790886551967), (206, 2213.9700000000003, 0.7561421719229932), (207, 2224.08, 0.7555662299794059), (208, 2234.1899999999996, 0.7198102190651604), (209, 2244.3, 0.6391161943925512), (210, 2254.41, 0.5868333507257852), (211, 2264.52, 0.5941310660092013), (214, 2294.85, 0.3391786131096566), (215, 2304.96, 0.4057193089010108), (216, 2315.0699999999997, 0.2540838766907701), (217, 2325.18, 0.2732431632149679), (218, 2335.29, 0.16807159098677862), (219, 2345.3999999999996, -0.1224714043696416), (220, 2355.51, -0.1175899111950894), (221, 2365.62, -0.17924784347434627), (222, 2375.73, -0.39522574281721734), (223, 2385.84, -0.6550523055072612), (224, 2395.95, -0.47849642086072536)]

# /mnt/pictures-L1G-TIFF/AtacamaDesert/EO1H2330752011243110KF_HYP_L1G
# in [950:1500,430:600] in which band 138 is < 0.4 times its maximum (to carve out riverbeds)

atacama = [(8, 425.574, 4.909096920323415), (9, 435.787, 4.9206597757615835), (10, 446.0, 4.949533156078991), (12, 466.426, 5.067137541480137), (13, 476.639, 5.147097538970966), (14, 486.852, 5.100780626934357), (15, 497.065, 5.1270625662269795), (16, 507.278, 5.159169136364118), (17, 517.491, 5.11561003409922), (18, 527.704, 5.154512480030207), (19, 537.917, 5.15753656852248), (20, 548.13, 5.171960926580547), (21, 558.343, 5.1836292511833735), (22, 568.556, 5.174989445477717), (23, 578.769, 5.18306065149316), (25, 599.1949999999999, 5.211809112685964), (27, 619.621, 5.187149951467758), (28, 629.834, 5.164594648706961), (29, 640.047, 5.169851774807468), (30, 650.26, 5.182128099475104), (31, 660.473, 5.128924902236881), (32, 670.6859999999999, 5.15477787595344), (33, 680.899, 5.143467489843838), (34, 691.112, 5.080122287370413), (35, 701.325, 5.115275778107418), (36, 711.538, 5.067258129871343), (37, 721.751, 5.040406094941711), (38, 731.9639999999999, 5.040905280040468), (39, 742.1769999999999, 5.022856512369236), (40, 752.39, 4.955543654293354), (41, 762.603, 4.660738064622367), (43, 783.029, 4.958036812283198), (44, 793.242, 4.927323922397974), (45, 803.4549999999999, 4.904830612557056), (46, 813.6679999999999, 4.871586143059499), (47, 823.881, 4.836555674638481), (48, 834.094, 4.820598523328194), (49, 844.307, 4.829644400050183), (50, 854.52, 4.806263577090875), (51, 864.733, 4.781214815185698), (52, 874.9459999999999, 4.750963505809418), (53, 885.159, 4.7143557347674285), (54, 895.372, 4.665704678705648), (55, 905.585, 4.609816943213804), (56, 915.798, 4.558341457105168), (57, 926.011, 4.504152536829525), (77, 909.78, 4.6649322025864315), (78, 919.89, 4.620779563606213), (79, 930.0, 4.46901294640885), (80, 940.11, 4.470434361717175), (81, 950.22, 4.474222037666877), (82, 960.33, 4.501643433418701), (83, 970.44, 4.5074170619066845), (84, 980.55, 4.501542488539363), (85, 990.66, 4.493258759937311), (86, 1000.77, 4.464600761797369), (87, 1010.88, 4.4608328766276), (88, 1020.99, 4.449406246414378), (89, 1031.1, 4.421831207437596), (90, 1041.21, 4.405290495175423), (91, 1051.32, 4.378233201464959), (92, 1061.43, 4.3437518720524775), (93, 1071.54, 4.3232304708065765), (95, 1091.76, 4.272323520733693), (96, 1101.87, 4.248598141985884), (97, 1111.98, 4.122478663336511), (98, 1122.09, 3.9950247604366638), (99, 1132.2, 4.006542286234581), (100, 1142.31, 4.022535997556963), (101, 1152.42, 4.05001118986047), (102, 1162.53, 4.078048657826606), (103, 1172.6399999999999, 4.05610794698716), (104, 1182.75, 4.024379379324442), (105, 1192.8600000000001, 3.9984641310156928), (106, 1202.97, 3.963008498917064), (107, 1213.08, 3.977200967880676), (108, 1223.19, 3.970638959061609), (109, 1233.3, 3.9579623043949654), (110, 1243.4099999999999, 3.940873293903224), (111, 1253.52, 3.888814666542654), (112, 1263.63, 3.777071789819186), (113, 1273.74, 3.8241886075144316), (114, 1283.85, 3.8617243177194207), (115, 1293.96, 3.8672509892699076), (116, 1304.07, 3.835283587811248), (117, 1314.1799999999998, 3.7850311802267522), (118, 1324.29, 3.736552780740043), (119, 1334.4, 3.6745203172433087), (120, 1344.51, 3.42408741172601), (121, 1354.62, 2.7340752432051376), (122, 1364.73, 2.3744308137761623), (123, 1374.84, 2.607771438572702), (124, 1384.95, 2.610452110648087), (125, 1395.06, 2.6524397344928072), (126, 1405.17, 2.6952646338141566), (127, 1415.28, 2.8106070190736556), (128, 1425.3899999999999, 2.7948894771805426), (129, 1435.5, 2.6724376542032724), (130, 1445.6100000000001, 2.732326679356489), (131, 1455.72, 2.898533659137927), (132, 1465.83, 2.87625361984818), (133, 1475.94, 2.922520575282705), (134, 1486.05, 2.9621006246982837), (135, 1496.1599999999999, 3.0508968397219207), (136, 1506.27, 3.1151047706071617), (137, 1516.38, 3.1442792873864143), (138, 1526.49, 3.1256711683242377), (139, 1536.6, 3.112930403836687), (141, 1556.82, 3.1650898942581667), (142, 1566.9299999999998, 3.1301945524130037), (143, 1577.04, 3.1126550699273743), (144, 1587.15, 3.158635352809702), (145, 1597.26, 3.1521460942980113), (146, 1607.37, 3.149299289943671), (147, 1617.48, 3.19655999557847), (148, 1627.59, 3.212572679868883), (149, 1637.6999999999998, 3.171700119823305), (150, 1647.81, 3.1680446831911473), (151, 1657.92, 3.16936591132036), (153, 1678.1399999999999, 3.129412920320415), (154, 1688.25, 3.1151872695662517), (155, 1698.36, 3.0785022779143714), (156, 1708.4699999999998, 3.013047746311332), (157, 1718.58, 2.9377877412369777), (158, 1728.69, 2.8323658450535643), (160, 1748.9099999999999, 2.7122667833488903), (161, 1759.02, 2.7100252497750525), (162, 1769.13, 2.6881799689813586), (163, 1779.24, 2.640672811750071), (164, 1789.35, 2.6086496292191304), (165, 1799.46, 2.4462276559144627), (166, 1809.57, 2.2855574829543515), (167, 1819.6799999999998, 2.1112527661486737), (168, 1829.79, 1.799495337420146), (169, 1839.9, 1.4305914039180716), (170, 1850.01, 1.4753652764350031), (171, 1860.12, 1.5583864289093077), (172, 1870.23, 1.0405335500697572), (173, 1880.34, 1.4552940747572911), (174, 1890.4499999999998, 1.3554313747527933), (175, 1900.56, 0.8565377232596825), (176, 1910.67, 0.8064893514746105), (177, 1920.78, 0.8731818118386461), (178, 1930.8899999999999, 0.8520212193768386), (179, 1941.0, 0.8872588252981576), (180, 1951.11, 0.6621642961960149), (181, 1961.22, 0.6998248131200872), (182, 1971.33, 1.1243751752540156), (183, 1981.44, 1.4142260501657715), (184, 1991.55, 1.3723121639978206), (185, 2001.6599999999999, 0.5118177121467096), (186, 2011.77, 0.6778551894438132), (187, 2021.8799999999999, 1.4915900776627906), (188, 2031.99, 1.872697810463623), (190, 2052.21, 1.551714935209109), (191, 2062.3199999999997, 1.6140646041014035), (193, 2082.54, 1.8543581122733224), (194, 2092.6499999999996, 1.8828271820088125), (195, 2102.76, 1.8797910274983318), (196, 2112.87, 1.8469285355497223), (197, 2122.98, 1.8019854322174604), (198, 2133.09, 1.7790875526047338), (199, 2143.2, 1.7731253538135348), (200, 2153.31, 1.7259672430997566), (202, 2173.5299999999997, 1.5897821064791897), (203, 2183.64, 1.6159863080779417), (204, 2193.75, 1.5766524260815094), (205, 2203.8599999999997, 1.4724842914670324), (206, 2213.9700000000003, 1.4694017684245), (207, 2224.08, 1.4756595593189683), (209, 2244.3, 1.4412034975220536), (210, 2254.41, 1.398218146352261), (211, 2264.52, 1.3751551518315208), (212, 2274.63, 1.381757369789661), (213, 2284.74, 1.3484145035655961), (214, 2294.85, 1.3102522949270672), (215, 2304.96, 1.3463806075120737), (216, 2315.0699999999997, 1.3112448336504476), (217, 2325.18, 1.342726044522627), (218, 2335.29, 1.3088749265981197), (219, 2345.3999999999996, 1.2176518120725883), (220, 2355.51, 1.1778739460160343), (221, 2365.62, 1.1651517134224834), (222, 2375.73, 1.0760577634605273), (223, 2385.84, 0.999696205286132), (224, 2395.95, 0.9407708023924313)]

def wavelength(bandNumber):
    if bandNumber < 70.5:
        return (bandNumber - 10.) * 10.213 + 446.
    else:
        return (bandNumber - 79.) * 10.110 + 930.

exclusion = HistogramNonUniform(bins=[(0., 446.), (446., 930.), (930., 960.), (960., 1115.), (1115., 1150.), (1150., 1350.), (1350., 1480.), (1480., 1800.), (1800., 1970.), (1970., 2406.)], values=[20., -20., 20., -20., 20., -20., 20., -20., 20., -20.], linestyle="dotted", linecolor="grey", fillcolor="lightgrey")

plot_atacama = Scatter(x=[x[1] for x in atacama], y=[x[2]+5 for x in atacama], connector="unsorted", markersize=0.75, markercolor="red", linecolor="red")

plot_frome = Scatter(x=[x[1] for x in frome], y=[x[2]+5 for x in frome], connector="unsorted", markersize=0.75, yticks=dict([(x, unicode_number(x-5)) for x in (1, 3, 5, 7, 9, 11)] + [(x, None) for x in (2, 4, 6, 8, 10)]), xlabel="wavelength [nm]", ylabel=u"log radiance [log W/m/m/sr/\u03bcm]", xmin=450., xmax=2400.)

legend = Legend([[plot_frome, "salt of Lake Frome"], [plot_atacama, "salt in Atacama Desert"], [exclusion, "excluded bands"]], justify="cl", colwid=[0.2, 0.8], width=0.6)

draw(Overlay(3,
             exclusion,
             Grid(vert=[760.]),
             plot_atacama,
             plot_frome,
             legend,
             ), fileName="spectra.svg")


